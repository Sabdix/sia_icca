
@{
  ViewBag.Title = "Sucursales";
  Layout = "~/Views/Shared/_LayoutRolesUsuario.cshtml";

  <script>
    nodoMenu = "administradores";
    submenu = "SuperAdministradores";
  </script>
}
@using System.Globalization;
@using IICA.Models.Entidades.Sucursales;
@using System.Web.Script.Serialization;
@using IICA.Models.Entidades

@model IICA.Models.Entidades.Sucursales.Sucursal

<ul class="breadcrumb">
  <li>
    <p>Sucursales</p>
  </li>
  <li><a href="#" class="active">Sucursales</a> </li>
</ul>

<div class="row-fluid">
  <div class="span12">
    <div class="grid simple ">
      <div class="grid-title">
        <h4>Lista <span class="semi-bold">de sucursales</span></h4>
        <button type="button" data-toggle="modal" data-target="#modal-registrar-sucursal"
                onclick="MostrarModalAddSucursal()" style="float: right" class="btn btn-info btn-xs btn-mini">
          <i class="fa fa-plus-circle"></i>&nbsp;Agregar
        </button>
      </div>
      <div class="grid-body ">
        <table class="table table-hover no-more-tables" style="text-align: center;" id="tabla-sucursales">
          <thead>
            <tr>
              <th style="width:5%;text-align: left;">Clave</th>
              <th style="width: 20%; text-align: left;">Nombre</th>
              <th style="width: 20%; text-align: left;">Estado</th>
              <th style="width:12%;text-align: center;">Acciones</th>
            </tr>
          </thead>
          <tbody>
            @foreach (Sucursal sucursal in ViewBag.Sucursales) {
              <tr>
                <td style="text-align: left;">@sucursal.clave</td>
                <td style="text-align: left;">@sucursal.nombre</td>
                <td style="text-align: left;">@(sucursal.estatus ? "Habilitado" : "Inhabilitado")</td>
                <td>
                  <span data-toggle="modal" data-target="#modal-registrar-sucursal">
                    <button data-toggle="tooltip" title="Editar sucursal" class="btn btn-success btn-mini" onclick="MostrarModalEditarSucursal('@(sucursal.clave)', '@(sucursal.nombre)')">
                      <i class="fa fa-check-square-o"></i>
                    </button>
                  </span>
                  <span data-toggle="modal" data-target="#modal-estatus-sucursal">
                    <button data-toggle="tooltip" title="@(sucursal.estatus ? "Deshabilitar":"Habilitar") sucursal" class="btn @(sucursal.estatus? "btn-warning": " btn-info") btn-mini"
                            onclick="OnActualizarEstadoSucursal('@sucursal.clave',@(sucursal.estatus? 0: 1), '@(sucursal.nombre)')">
                      <i class="fa @(sucursal.estatus ? "fa-lock" :  "fa-unlock-alt")"></i>
                    </button>
                  </span>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modal-registrar-sucursal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <br>
        <i class="fa fa-building fa-5x"></i>
        <h4 id="myModalLabel" class="semi-bold">Registro de @ViewBag.Title.</h4>
      </div>
      <div class="modal-body">
        <form id="form-registrar-sucursal">
          <div class="row form-row">
            <div class="col-md-4">
              <label class="form-label">Nombre:</label>
              @Html.TextBoxFor(x => x.nombre, new { @class = "form-control", placeholder = "Nombre" })
              @Html.ValidationMessageFor(x => x.nombre, "", new { @class = "error" })
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-success" onclick="OnGuardarSucursal()">Guardar</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modal-estatus-sucursal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <br>
        <i class="fa fa-question-circle fa-7x"></i>
        <h4 id="myModalLabel" class="semi-bold">¿Realmente desea <span id="m-estatus-actividad"></span> la siguiente sucursal?.</h4>
        <p class="no-margin">A continuación se muestran los detalles de la sucursal </p>
        <br>
      </div>
      <div class="modal-body">
        <form id="form-estatus-usuario">
          <div class="row form-row">
            <div class="col-md-4">
              <label class="form-label">Nombre:</label>
              @Html.TextBoxFor(x => x.nombre, new { @class = "form-control", placeholder = "Nombre", @readonly = "readonly " })
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary" id="m-btnAceptar" onclick="ActualizarEstadoSucursal()">Activar</button>
      </div>
    </div>

  </div>

</div>

@section scripts{
  <link href="~/Content/assets/plugins/jquery-datatable/css/jquery.dataTables.css" rel="stylesheet" type="text/css" />
  <link href="~/Content/assets/plugins/datatables-responsive/css/datatables.responsive.css" rel="stylesheet" type="text/css" media="screen" />


  @* Son para el estilo de los select ya que estan en el layout pero no funcionan si no estan en cada vista *@
  <link href="~/Content/assets/plugins/bootstrap-select2/select2.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="~/Content/webarch/css/webarch.css" rel="stylesheet" type="text/css" />
  <script src="~/Content/assets/plugins/bootstrap-select2/select2.min.js"></script>

  <script src="~/Content/assets/plugins/jquery-datatable/js/jquery.dataTables.min.js" type="text/javascript"></script>
  <script src="~/Content/assets/plugins/jquery-datatable/extra/js/dataTables.tableTools.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="~/Content/assets/plugins/datatables-responsive/js/datatables.responsive.js"></script>
  <script type="text/javascript" src="~/Content/assets/plugins/datatables-responsive/js/lodash.min.js"></script>
  <script src="~/Content/assets/js/datatables.js"></script>

  <script src="~/Scripts/jquery.validate.min.js"></script>
  <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
  <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
  <script src="~/Content/assets/js/Evt/Sucursal/evtSucursales.js"></script>

}